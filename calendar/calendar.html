<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="../wit.css">
    <link rel="stylesheet" href="../style.main.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/6.1.15/index.global.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/6.1.15/index.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script defer src="../app/wit.js"></script>


</head>


<body>
    <!-- 공통영역 -->
    <div class="container">
        <div class="sideBar">
            <div class="top">
                <i class="bx bx-menu" id="btn"></i>
            </div>
            <div class="user">
                <img src="../images/logo/WIT_logo1.png" alt="me" class="userImg">
                <div class="nickName">
                    <p class="bold">Wit Works</p>
                    <p></p>
                </div>
            </div>

            <ul>
                <li>
                    <a href="#">
                        <i class='bx bxs-home-alt-2'></i>
                        <span class="navItem">홈</span>
                    </a>
                    <span class="toolTip">홈</span>
                </li>
                <li>
                    <a href="#">
                        <i class='bx bx-paperclip'></i>
                        <span class="navItem">주소록</span>
                    </a>
                    <span class="toolTip">주소록</span>
                </li>
                <li>
                    <a href="board2.html">
                        <i class="bx bxs-grid-alt"></i>
                        <span class="navItem">게시판</span>
                    </a>
                    <span class="toolTip">게시판</span>
                </li>
                <li>
                    <a href="#">
                        <i class='bx bx-calendar-alt'></i>
                        <span class="navItem">캘린더</span>
                    </a>
                    <span class="toolTip">캘린더</span>
                </li>
                <li>
                    <a href="#">
                        <i class='bx bxs-message-dots'></i>
                        <span class="navItem">메신저</span>
                    </a>
                    <span class="toolTip">메신저</span>
                </li>
                <li>
                    <a href="#">
                        <i class='bx bx-clipboard'></i>
                        <span class="navItem">전자결재</span>
                    </a>
                    <span class="toolTip">전자결재</span>
                </li>
                <li>
                    <a href="#">
                        <i class='bx bxs-briefcase-alt-2'></i>
                        <span class="navItem">근태관리</span>
                    </a>
                    <span class="toolTip">근태관리</span>
                </li>
                <li>
                    <a href="#">
                        <i class='bx bxs-check-square'></i>
                        <span class="navItem">예약</span>
                    </a>
                    <span class="toolTip">예약</span>
                </li>
                <li>
                    <a href="#">
                        <i class='bx bx-sitemap'></i>
                        <span class="navItem">조직도</span>
                    </a>
                    <span class="toolTip">조직도</span>
                </li>

            </ul>
        </div>
        <!-- 공통역역 끝 -->

        <div class="main-content">
            <div class="header">
                <span class="alert"><a href=""><i class='bx bxs-bell'></i></a></span>
                <!--마이페이지로 이동-->
                <span class="myName">
                    <img src="../images/프로필.jpg"><a href=" #">이원희 사원</a></span>
                <span class="logOut"><a href="#">LogOut</a></span>
            </div>
            <div class="contents">
                <div class="sideAbout">
                    <div class="sideTxt">
                        <h2 class="sideTit">캘린더</h2>
                    </div>
                    <div class="sideBtnBox">
                        <button class="plusBtn sideBtn">일정 등록</button>
                    </div>
                    <div class="addressListPrivate">
                        <ul class="privateList">
                            <li class="toggleItem">
                                <h3 class="toggleTit">내 캘린더</h3>
                                <ul class="subList calendarList">
                                    <li>
                                        <input type="checkbox" id="myCheckBox" name="myCheckBox" class="active">
                                        <label for="myCheckBox">내 일정(기본)</label>
                                    </li>
                                    <li><input type="checkbox" id="travelCheckBox" name="travelCheckBox">
                                        <label for="travelCheckBox">여행</label>
                                        <span class="sideSelectDel">&times</span>
                                    </li>
                                    <div>
                                        <span class="sideCalendarAdd">
                                            <i class='bx bx-plus-medical'></i>
                                            <span class="myCalendarAdd">내 캘린더 추가</span>
                                            <div class="myCalendarPopup">
                                                <header>
                                                    <h3>내 캘린더 추가<span class="myPopupClose">&times</span></h3>
                                                </header>
                                                <div class="content">
                                                    <input type="text">
                                                </div>
                                                <footer>
                                                    <div class="btns">
                                                        <button id="sideMyAdd" class="okBtn">확인</button><button
                                                            id="sideMyCancel" class="cancelBtn">취소</button>
                                                    </div>
                                                </footer>
                                            </div>
                                        </span>
                                    </div>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div class="addressListGroup">
                        <ul class="GroupList">
                            <li class="toggleItem">
                                <h3 class="toggleTit">부서 캘린더</h3>
                                <ul class="subList calendarList">
                                    <li><input type="checkbox" id="deptMeeting" name="deptMeeting">
                                        <label for="deptMeeting">회의 일정(기본)</label>
                                    </li>
                                    <li><input type="checkbox" id="deptBirthday" name="deptBirthday">
                                        <label for="deptBirthday">부서원 생일(기본)</label>
                                    </li>
                                    <div>
                                        <span class="sideCalendarAdd">
                                            <i class='bx bx-plus-medical'></i>
                                            <span class="deptCalendarAdd">부서 캘린더 추가</span>
                                            <div class="deptCalendarPopup">
                                                <header>
                                                    <h3>부서 캘린더 추가<span class="deptPopupClose">&times</span></h3>
                                                </header>
                                                <div class="content">
                                                    <input type="text">
                                                </div>
                                                <footer>
                                                    <div class="btns">
                                                        <button id="sideDeptAdd" class="okBtn">확인</button><button
                                                            id="sideDeptCancel" class="cancelBtn">취소</button>
                                                    </div>
                                                </footer>
                                            </div>
                                        </span>
                                    </div>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="sideContents calendarBox">
                    <div id="calendar" class="calendar"></div>
                </div>
            </div>
        </div>
        <!-- 날짜 박스 눌렀을 시 모달 -->
        <div id="calendarModal" class="modal">
            <div class="modalContent">
                <h1>일정등록<span class="modalClose">&times</span></h1>
                <div class="calendarAdd">
                    <ul>
                        <li>
                            <span>일정명</span>
                            <div><input type="text"></div>
                        </li>
                        <li>
                            <span>일정기간</span>
                            <div><input type="date" class="startDate dateInput">&nbsp;&nbsp;<input type="time"
                                    class="startDate dateInput" step="600">&nbsp;&nbsp;~&nbsp;&nbsp;<input type="date"
                                    class="endDate dateInput">&nbsp;&nbsp;<input type="time" class="endDate dateInput"
                                    step="600">
                            </div>
                        </li>
                        <li>
                            <span>내 캘린더</span>
                            <div><select name="calendar" id="choiCalendar">
                                    <option value="1">웡히 캘린더</option>
                                    <option value="1">바보 캘린더</option>
                                </select></div>
                        </li>
                        <li>
                            <span>장소</span>
                            <div><input type="text" class="eventLocation"></div>
                        </li>
                        <li>
                            <span>내용</span>
                            <div><textarea id="calendarText"></textarea></div>
                        </li>
                        <li>
                            <div class="btns">
                                <button id="addBtn" class="okBtn">완료</button><button class="cancelBtn">취소</button>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- event 클릭 시 모달 -->
        <div id="eventModal" class="modal">
            <div class="modalContent">
                <h1>일정 내용<span class="modalClose" id="eventModalClose">&times</span></h1>
                <div class="eventCheck">
                    <ul>
                        <li>
                            <span>일정명</span>
                            <div><input type="text" class="eventName" disabled></div>
                        </li>
                        <li>
                            <span>일정기간</span>
                            <div><input type="date" id="startDate" class="startDate dateInput"
                                    disabled>&nbsp;&nbsp;<input type="time" id="startTime" class="startDate dateInput"
                                    disabled>&nbsp;&nbsp;~&nbsp;&nbsp;<input type="date" id="endDate"
                                    class="endDate dateInput" disabled>&nbsp;&nbsp;<input type="time" id="endTime"
                                    class="endDate dateInput" disabled>
                            </div>
                        </li>
                        <li>
                            <span>내 캘린더</span>
                            <div><select name="calendar" id="choiEvent" disabled>
                                    <option value="1">웡히 캘린더</option>
                                    <option value="1">바보 캘린더</option>
                                </select></div>
                        </li>
                        <li>
                            <span>장소</span>
                            <div><input type="text" class="eventLocation" value="1층 회의실" disabled></div>
                        </li>
                        <li>
                            <span>내용</span>
                            <div><textarea id="eventText" disabled>ㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇㅇ</textarea></div>
                        </li>
                        <li>
                            <div class="btns">
                                <button id="editBtn">수정</button><button id="confirmBtn" class="okBtn">확인</button><button
                                    class="deleteBtn">삭제</button><button class="cancelBtn editCancelBtn">취소</button>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

    </div>

</body>
<!-- sidebar 공통요소 script -->
<script>
    let btn = document.querySelector("#btn")
    let sideBar = document.querySelector(".sideBar")

    btn.onclick = function () {
        sideBar.classList.toggle("active")
    };

    const toggleItems = document.querySelectorAll('.toggleItem');

    toggleItems.forEach(function (toggleItem) {
        const toggleTit = toggleItem.querySelector('.toggleTit');
        const subList = toggleItem.querySelector('.subList');

        toggleTit.addEventListener('click', function () {
            subList.classList.toggle('active');
            toggleTit.classList.toggle('active'); // 이미지 회전을 위해 클래스 추가
        });
    });

    $('.myCalendarAdd').on('click', function () {
        $('.myCalendarPopup').show();
    })

    $('.myPopupClose').on('click', function () {
        $('.myCalendarPopup').hide();
    })

    $('.deptCalendarAdd').on('click', function () {
        $('.deptCalendarPopup').show();
    })

    $('.deptPopupClose').on('click', function () {
        $('.deptCalendarPopup').hide();
    })






    // 이벤트 클릭해서 수정 버튼 눌렀을 시
    $('#editBtn').on('click', function () {
        var $inputs = $('.eventCheck input, .eventCheck select, .eventCheck textarea');
        $inputs.prop('disabled', false);
        $('#editBtn').hide();
        $('.deleteBtn').hide();
        $('#confirmBtn').show();
        $('.cancelBtn').show();
    });

    // 이벤트 모달창에서 X버튼 눌렀을 시
    $('#eventModalClose').on('click', function () {
        location.reload();
    })

    // 모달창에서 확인 버튼 눌렀을 시
    $('#confirmBtn').on('click', function () {
        var $inputs = $('.eventCheck input, .eventCheck select, .eventCheck textarea');
        $inputs.prop('disabled', true);
        $('#eventModal').hide();
        $('#confirmBtn').hide();
        $('#editBtn').show();
    });

    $('.cancelBtn').on('click', function () {
        location.reload();
    })

    $('.deleteBtn').on('click', function () {

    })

    $('#addBtn').on('click', function () {
        // 입력 필드값 변수에 저장
        let eventName = $('#eventName').val();
        let startDate = $('#startDate').val();
        let startTime = $('#startTime').val();
        let endDate = $('#endDate').val();
        let endTime = $('#endTime').val();
        let calendar = $('#choiCalendar').val();
        let eventLocation = $('#eventLocation').val();
        let calendarText = $('#calendarText').val();

        // 입력 필드에서 가져온 값을 사용하여 이벤트 객체 생성
        let event = {
            eventName: eventName,
            startDate: startDate,
            startTime: startTime,
            endDate: endDate,
            endTime: endTime,
            calendar: calendar,
            eventLocation: eventLocation,
            calendarText: calendarText
        };

        $('#calendarModal').hide();
    })

    $('.plusBtn.sideBtn').on('click', function () {
        $("#calendarModal").show();
        $(".modalClose").on("click", function () {
            $("#calendarModal").hide();
        })
    })





    document.addEventListener('DOMContentLoaded', function () {
        var calendarEl = document.getElementById('calendar');

        var calendar = new FullCalendar.Calendar(calendarEl, {

            googleCalendarApiKey: "AIzaSyAnwaZWB863SwNcT5q--le6nXP51P8goCI",
            headerToolbar: {
                left: 'prev,next today',
                center: 'title',
                right: 'dayGridMonth,timeGridWeek,timeGridDay,listMonth'
            },
            // '일 제거' 안뇽~~~~~~~~~~~~~나누구겡 ㅋㅋ
            dayCellContent: function (e) {
                return e.dayNumberText.replace('일', '');
            },


            locale: "ko", // 한국어로 변경
            initialDate: new Date(), // 캘린더 처음 들어갔을 때 오늘 날짜 기준으로 지정 ex) 7월 1일이면 7월 1일에 포커스
            timeZone: 'Asia/Seoul',
            navLinks: true, // can click day/week names to navigate views
            businessHours: true, // display business hours
            editable: true,
            dayMaxEvents: true, // allow "more" link when too many events
            selectable: true,
            buttonText: {
                today: '오늘',
                month: '월간',
                week: '주간',
                day: '일간',
                list: '목록'
            },
            dateClick: function (info) {
                //날짜 클릭 시 발생할 이벤트
                console.log(info.dateStr);
                $('.startDate').val(info.dateStr);
                $("#calendarModal").show();

                $(".modalClose").on("click", function () {
                    $("#calendarModal").hide();
                });
            },
            eventClick: function (info) {
                // 이벤트 클릭 시 발생할 이벤트
                let eventTitle = info.event._def.title;
                // 이벤트 시작 날짜를 ISO 형식으로 변환
                // 이벤트의 시작과 종료 시간을 한국 시간으로 변환
                let eventStartUTC = new Date(info.event.start);
                let eventEndUTC = info.event.end ? new Date(info.event.end) : new Date(eventStartUTC.getTime() + 24 * 60 * 60 * 1000);

                // 한국 표준시(KST)로 변환
                let eventStartKST = new Date(eventStartUTC.toLocaleString('en-US', { timeZone: 'Asia/Seoul' }));
                let eventEndKST = new Date(eventEndUTC.toLocaleString('en-US', { timeZone: 'Asia/Seoul' }));

                // 날짜와 시간 분리
                let eventStartDate = eventStartKST.toISOString().split('T')[0];
                let eventStartTime = eventStartKST.toISOString().split('T')[1].substring(0, 5);
                let eventEndDate = eventEndKST.toISOString().split('T')[0];
                let eventEndTime = eventEndKST.toISOString().split('T')[1].substring(0, 5);
                let eventContent = info.event.extendedProps.content;

                console.log(eventStartDate + ' : ' + eventStartTime);
                // console.log(new Date(info.event.start.getTime() - 9 - (info.event.start.getTimezoneOffset() * 60000)).toISOString().split('T')[1].substring(0, 5));

                $('.eventName').val(eventTitle);
                $('#startDate').val(eventStartDate);
                $('#startTime').val(eventStartTime);
                $('#endDate').val(eventEndDate);
                $('#endTime').val(eventEndTime);
                $('#eventText').val(eventContent);


                $("#eventModal").show();
                $(".modalClose").on("click", function () {
                    $("#eventModal").hide();
                });
            },


            droppable: true,
            eventSources: // 한국 공휴일 ko.south_korea 추가
                [{ googleCalendarId: 'f6eab8c8b4f8106bf35e055c7e44acd01f9e147d11483c67ed358d42a151eeec@group.calendar.google.com' }
                    , {
                    googleCalendarId: 'ko.south_korea#holiday@group.v.calendar.google.com'
                    , className: 'ko_event',
                    textColor: 'red'
                }],

            events: [
                {
                    title: 'Business Lunch',
                    start: '2024-07-03T02:00:00',
                    end: '2024-07-05T23:00:00',
                    constraint: 'businessHours'
                },
                {
                    title: 'Business Lunch',
                    start: '2024-07-03T13:00:00',
                    constraint: 'businessHours'
                },
                {
                    title: 'Business Lunch',
                    start: '2024-07-03',
                    constraint: 'businessHours'
                },
                {
                    title: 'Business Lunch',
                    start: '2024-07-03T13:00:00',
                    constraint: 'businessHours'
                },
                {
                    title: 'Meeting',
                    start: '2024-07-13T11:07 m887 58mn80:00',
                    constraint: 'availableForMeeting', // defined below
                    color: '#257e4a'
                },
                // 09시부터 하루 시작
                {
                    title: 'Conference',
                    start: '2024-07-17T09:00:00',
                    end: '2024-07-19T11:12:00'
                },
                {
                    title: 'Party',
                    start: '2024-07-29T20:00:00',
                    end: '2024-07-29T22:00:00'
                },

                // areas where "Meeting" must be dropped
                {
                    groupId: 'availableForMeeting',
                    start: '2024-07-11T10:00:00',
                    end: '2024-07-11T16:00:00',
                    display: 'background'
                },
                {
                    groupId: 'availableForMeeting',
                    start: '2024-07-13T10:00:00',
                    end: '2024-07-13T16:00:00',
                    display: 'background'
                },

                // red areas where no events can be dropped
                // {
                //     start: '2024-07-24',
                //     end: '2024-07-28',
                //     overlap: false,
                //     display: 'background',
                //     color: '#ff9f89',
                //     clickable: false  // 클릭 비활성화
                // },
                // {
                //     start: '2024-07-06',
                //     end: '2024-07-08',
                //     overlap: false,
                //     display: 'background',
                //     color: '#ff9f89',
                //     clickable: false  // 클릭 비활성화
                // },
            ]


        });

        calendar.render();
    });
</script>

</html>